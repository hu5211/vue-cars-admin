{"remainingRequest":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-cars\\vue-cars-admin\\src\\components\\common\\cityArea\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue-cars\\vue-cars-admin\\src\\components\\common\\cityArea\\index.vue","mtime":1598700706033},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBHZXRDaXR5IH0gZnJvbSAiQC9hcGkvY29tbW9uIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImNpdHlBcmVhIiwNCiAgZGF0YSgpIHsNCiAgICBjb25zdCBfdGhpcyA9IHRoaXM7DQogICAgcmV0dXJuIHsNCiAgICAgIGFkZHJlc3M6IFtdLA0KICAgICAgYWRkcmVzc0RhdGE6IHt9LA0KICAgICAgdmFsdWU6ICIiLA0KICAgICAgY2FzY2FkZXJfb3B0aW9uczogW10sDQogICAgICBjYXNjYWRlcl9wcm9wczogew0KICAgICAgICBsYXp5OiB0cnVlLA0KICAgICAgICBsYXp5TG9hZChub2RlLCByZXNvbHZlKSB7DQogICAgICAgICAgY29uc3QgbGV2ZWwgPSBub2RlLmxldmVsOw0KICAgICAgICAgIC8v6K+35rGC5Y+C5pWwDQogICAgICAgICAgY29uc3QgcmVxdWVzdERhdGEgPSB7fTsNCiAgICAgICAgICAvL+WjsOaYjuiHquWumuS5iemFjee9rg0KICAgICAgICAgIGNvbnN0IGpzb25UeXBlID0gew0KICAgICAgICAgICAgMDogeyB0eXBlOiAicHJvdmluY2UiIH0sDQogICAgICAgICAgICAxOiB7IHR5cGU6ICJjaXR5IiwgY29kZTogInByb3ZpbmNlIiB9LA0KICAgICAgICAgICAgMjogeyB0eXBlOiAiYXJlYSIsIGNvZGU6ICJjaXR5IiB9DQogICAgICAgICAgfTsNCiAgICAgICAgICBpZiAoanNvblR5cGVbbGV2ZWxdLmNvZGUpIHsNCiAgICAgICAgICAgIHJlcXVlc3REYXRhW2Ake2pzb25UeXBlW2xldmVsXS5jb2RlfV9jb2RlYF0gPSBub2RlLnZhbHVlOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXF1ZXN0RGF0YS50eXBlID0ganNvblR5cGVbbGV2ZWxdLnR5cGU7DQoNCiAgICAgICAgICBHZXRDaXR5KHJlcXVlc3REYXRhKS50aGVuKHJlc29uc2UgPT4gew0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc29uc2UuZGF0YS5kYXRhOw0KICAgICAgICAgICAgY29uc3QgdHlwZSA9IGpzb25UeXBlW2xldmVsXS50eXBlLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAvL+iHquWumuS5iSB2YWx1ZSBsYWJlbA0KICAgICAgICAgICAgZGF0YS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICBpdGVtLnZhbHVlID0gaXRlbVtgJHt0eXBlfV9DT0RFYF07DQogICAgICAgICAgICAgIGl0ZW0ubGFiZWwgPSBpdGVtW2Ake3R5cGV9X05BTUVgXTsNCiAgICAgICAgICAgICAgaWYgKGxldmVsID09PSAyKSB7DQogICAgICAgICAgICAgICAgaXRlbS5sZWFmID0gbGV2ZWwgPj0gMjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAvL+WtmOWCqOecgeW4guaVsOaNrg0KICAgICAgICAgICAgX3RoaXMuYWRkcmVzc0RhdGFbanNvblR5cGVbbGV2ZWxdLnR5cGVdID0gZGF0YTsNCiAgICAgICAgICAgIC8v6L+U5Zue6IqC54K55pWw5o2uDQogICAgICAgICAgICByZXNvbHZlKGRhdGEpOw0KICAgICAgICAgIH0pOw0KICAgICAgICAgIC8vIOiOt+WPlmFkZHJlc3MNCiAgICAgICAgICBpZiAobm9kZS5sZXZlbCAhPT0gMCkgew0KICAgICAgICAgICAgX3RoaXMuZ2V0QWRkcmVzcyhub2RlKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0sDQogICAgICBpbml0VmFsdWU6ICLor7fpgInmi6nnnIHluILljLoiLA0KICAgICAgaW5pdFZhbHVlRmxhZzogZmFsc2UNCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy/liJ3lp4vljJbpu5jorqTlgLwNCiAgICBpbml0RGVmYXVsdCh2YWx1ZSkgew0KICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgIHRoaXMuaW5pdFZhbHVlRmxhZyA9IHRydWU7DQogICAgICAgIHRoaXMuaW5pdFZhbHVlID0gdmFsdWUuc3BsaXQoIiwiKS5qb2luKCIgLyAiKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNoYW5nZVZhbHVlKHZhbHVlKSB7DQogICAgICB0aGlzLiRlbWl0KCJ1cGRhdGU6Y2l0eUFyZWFWYWx1ZSIsIHZhbHVlLmpvaW4oKSk7DQogICAgICAvL+WMuemFjeacgOWQjuS4gOmhuQ0KICAgICAgY29uc3QgbGFzdENvZGUgPSB2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXTsNCiAgICAgIGNvbnN0IGFyZWEgPSB0aGlzLmFkZHJlc3NEYXRhLmFyZWEuZmlsdGVyKA0KICAgICAgICBpdGVtID0+IGl0ZW0udmFsdWUgPT0gbGFzdENvZGUNCiAgICAgIClbMF07DQogICAgICB0aGlzLmFkZHJlc3NbMl0gPSBhcmVhLmxhYmVsOw0KICAgICAgdGhpcy5nZXRBZGRyZXNzKCk7DQogICAgfSwNCiAgICAvLyDojrflj5bkuK3mloflnLDlnYANCiAgICBnZXRBZGRyZXNzKG5vZGUpIHsNCiAgICAgIGlmIChub2RlKSB7DQogICAgICAgIGNvbnN0IGluZGV4ID0gbm9kZS5sZXZlbCAtIDE7DQogICAgICAgIHRoaXMuYWRkcmVzc1tpbmRleF0gPSBub2RlLmxhYmVsOw0KICAgICAgfQ0KICAgICAgLy/kuLp0cnVl5pe277yM5omn6KGM5Zyw5Zu+5Lqk5LqSDQogICAgICBpZiAodGhpcy5tYXBMb2NhdGlvbikgew0KICAgICAgICB0aGlzLiRlbWl0KCJjYWxsYmFjayIsIHsNCiAgICAgICAgICBmdW5jdGlvbjogInNldE1hcENlbnRlciIsDQogICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgYWRkcmVzczogdGhpcy5hZGRyZXNzLmpvaW4oIiIpDQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v5riF6ZmkY2l0eQ0KICAgIGNsZWFyKCkgew0KICAgICAgdGhpcy52YWx1ZSA9ICIiOw0KICAgIH0NCiAgfSwNCiAgcHJvcHM6IHsNCiAgICBjaXR5QXJlYVZhbHVlOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogIiIgfSwNCiAgICBtYXBMb2NhdGlvbjogeyB0eXBlOiBCb29sZWFuLCBkZWZhdWx0OiBmYWxzZSB9DQogIH0NCn07DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/common/cityArea","sourcesContent":["<template>\r\n  <el-cascader\r\n    :class=\"{'cascader-input' : initValueFlag}\"\r\n    :placeholder=\"initValue\"\r\n    v-model=\"value\"\r\n    :options=\"cascader_options\"\r\n    :props=\"cascader_props\"\r\n    @change=\"changeValue\"\r\n  ></el-cascader>\r\n</template>\r\n\r\n<script>\r\nimport { GetCity } from \"@/api/common\";\r\nexport default {\r\n  name: \"cityArea\",\r\n  data() {\r\n    const _this = this;\r\n    return {\r\n      address: [],\r\n      addressData: {},\r\n      value: \"\",\r\n      cascader_options: [],\r\n      cascader_props: {\r\n        lazy: true,\r\n        lazyLoad(node, resolve) {\r\n          const level = node.level;\r\n          //请求参数\r\n          const requestData = {};\r\n          //声明自定义配置\r\n          const jsonType = {\r\n            0: { type: \"province\" },\r\n            1: { type: \"city\", code: \"province\" },\r\n            2: { type: \"area\", code: \"city\" }\r\n          };\r\n          if (jsonType[level].code) {\r\n            requestData[`${jsonType[level].code}_code`] = node.value;\r\n          }\r\n          requestData.type = jsonType[level].type;\r\n\r\n          GetCity(requestData).then(resonse => {\r\n            const data = resonse.data.data;\r\n            const type = jsonType[level].type.toUpperCase();\r\n            //自定义 value label\r\n            data.forEach(item => {\r\n              item.value = item[`${type}_CODE`];\r\n              item.label = item[`${type}_NAME`];\r\n              if (level === 2) {\r\n                item.leaf = level >= 2;\r\n              }\r\n            });\r\n            //存储省市数据\r\n            _this.addressData[jsonType[level].type] = data;\r\n            //返回节点数据\r\n            resolve(data);\r\n          });\r\n          // 获取address\r\n          if (node.level !== 0) {\r\n            _this.getAddress(node);\r\n          }\r\n        }\r\n      },\r\n      initValue: \"请选择省市区\",\r\n      initValueFlag: false\r\n    };\r\n  },\r\n  methods: {\r\n    //初始化默认值\r\n    initDefault(value) {\r\n      if (value) {\r\n        this.initValueFlag = true;\r\n        this.initValue = value.split(\",\").join(\" / \");\r\n      }\r\n    },\r\n    changeValue(value) {\r\n      this.$emit(\"update:cityAreaValue\", value.join());\r\n      //匹配最后一项\r\n      const lastCode = value[value.length - 1];\r\n      const area = this.addressData.area.filter(\r\n        item => item.value == lastCode\r\n      )[0];\r\n      this.address[2] = area.label;\r\n      this.getAddress();\r\n    },\r\n    // 获取中文地址\r\n    getAddress(node) {\r\n      if (node) {\r\n        const index = node.level - 1;\r\n        this.address[index] = node.label;\r\n      }\r\n      //为true时，执行地图交互\r\n      if (this.mapLocation) {\r\n        this.$emit(\"callback\", {\r\n          function: \"setMapCenter\",\r\n          data: {\r\n            address: this.address.join(\"\")\r\n          }\r\n        });\r\n      }\r\n    },\r\n    //清除city\r\n    clear() {\r\n      this.value = \"\";\r\n    }\r\n  },\r\n  props: {\r\n    cityAreaValue: { type: String, default: \"\" },\r\n    mapLocation: { type: Boolean, default: false }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>"]}]}
{"remainingRequest":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue","mtime":1598702059861},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovL0FNQVANCmltcG9ydCBBTWFwIGZyb20gIi4uL2FtYXAiOw0KLy8g57uE5Lu2DQppbXBvcnQgQ2l0eUFyZWEgZnJvbSAiQGMvY29tbW9uL2NpdHlBcmVhIjsNCi8vQVBJDQppbXBvcnQgeyBQYXJraW5nQWRkLCBQYXJraW5nRGV0YWlsZWQsIFBhcmtpbmdFZGl0IH0gZnJvbSAiQC9hcGkvcGFya2luZyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJQYXJraW5nQWRkIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgLy9pZA0KICAgICAgaWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkLA0KICAgICAgLy/lnLDlm77phY3nva4NCiAgICAgIG9wdGlvbl9tYXA6IHsgbWFwTG9hZDogdHJ1ZSB9LA0KICAgICAgc3RhdHVzOiB0aGlzLiRzdG9yZS5zdGF0ZS5jb25maWcucGFya2luZ19zdGF0dXMsDQogICAgICB0eXBlOiB0aGlzLiRzdG9yZS5zdGF0ZS5jb25maWcucGFya2luZ190eXBlLA0KICAgICAgZm9ybTogew0KICAgICAgICBwYXJraW5nTmFtZTogIiIsDQogICAgICAgIGFyZWE6ICIiLA0KICAgICAgICBhZGRyZXNzOiAiIiwNCiAgICAgICAgdHlwZTogIiIsDQogICAgICAgIGNhcnNOdW1iZXI6ICIiLA0KICAgICAgICBzdGF0dXM6ICIiLA0KICAgICAgICBsbmdsYXQ6ICIiLA0KICAgICAgICBjb250ZW50OiAiIg0KICAgICAgfSwNCiAgICAgIGJ1dHRvbl9sb2FkaW5nOiBmYWxzZSwNCiAgICAgIC8v6aqM6K+B6KGo5Y2V6KeE5YiZDQogICAgICBydWxlczogew0KICAgICAgICBwYXJraW5nTmFtZTogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXlgZzovablnLrlkI3np7AiLCB0cmlnZ2VyOiAiYmx1ciIgfQ0KICAgICAgICBdLA0KICAgICAgICBjYXJzTnVtYmVyOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuaVsOmHj+S4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9LA0KICAgICAgICAgIHsgdHlwZTogIm51bWJlciIsIG1lc3NhZ2U6ICLor7fovpPlhaXmlbDlrZciIH0NCiAgICAgICAgXSwNCiAgICAgICAgYXJlYTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fpgInmi6nln47luILljLoiLCB0cmlnZ2VyOiAiY2hhbmdlIiB9XSwNCiAgICAgICAgbG5nbGF0OiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIue7j+e6rOW6puS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9XQ0KICAgICAgfQ0KICAgIH07DQogIH0sDQogIGNvbXBvbmVudHM6IHsgQU1hcCwgQ2l0eUFyZWEgfSwNCiAgYmVmb3JlTW91bnQoKSB7fSwNCiAgbW91bnRlZCgpIHt9LA0KICBtZXRob2RzOiB7DQogICAgY2FsbGJhY2tDb21wb25lbnQocGFyYW1zKSB7DQogICAgICBpZiAocGFyYW1zLmZ1bmN0aW9uKSB7DQogICAgICAgIHRoaXNbcGFyYW1zLmZ1bmN0aW9uXShwYXJhbXMuZGF0YSk7DQogICAgICB9DQogICAgfSwNCiAgICAvL+WcsOWbvuWKoOi9veWujOaIkA0KICAgIG1hcExvYWQoKSB7DQogICAgICB0aGlzLmdldERldGFpbGUoKTsNCiAgICB9LA0KICAgIHNldE1hcENlbnRlcihkYXRhKSB7DQogICAgICB0aGlzLiRyZWZzLmFtYXAuc2V0TWFwQ2VudGVyKGRhdGEuYWRkcmVzcyk7DQogICAgfSwNCiAgICBnZXRMbmdsYXQoZGF0YSkgew0KICAgICAgdGhpcy5mb3JtLmxuZ2xhdCA9IGRhdGEubG5nbGF0LnZhbHVlOw0KICAgIH0sDQogICAgLy/mj5DkuqTooajljZUNCiAgICBvblN1Ym1pdChmb3JtTmFtZSkgew0KICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICB0aGlzLmJ1dHRvbl9sb2FkaW5nID0gdHJ1ZTsNCiAgICAgICAgICB0aGlzLmlkID8gdGhpcy5lZGl0UGFya2luZygpIDogdGhpcy5hZGRQYXJraW5nKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8v5paw5aKe5YGc6L2m5Zy6QVBJDQogICAgYWRkUGFya2luZygpIHsNCiAgICAgIFBhcmtpbmdBZGQodGhpcy5mb3JtKQ0KICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgdGhpcy5yZXNldCgiZm9ybSIpOw0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UubWVzc2FnZSwNCiAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIg0KICAgICAgICAgIH0pOw0KICAgICAgICAgIHRoaXMuYnV0dG9uX2xvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICB0aGlzLnJlc2V0KCk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgdGhpcy5idXR0b25fbG9hZGluZyA9IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICB9LA0KDQogICAgLy/nvJbovpHlgZzovablnLpBUEkNCiAgICBlZGl0UGFya2luZygpIHsNCiAgICAgIGxldCByZXF1ZXN0RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5mb3JtKSk7DQogICAgICByZXF1ZXN0RGF0YS5pZCA9IHRoaXMuaWQ7DQogICAgICBQYXJraW5nRWRpdChyZXF1ZXN0RGF0YSkNCiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgIHRoaXMucmVzZXQoImZvcm0iKTsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLm1lc3NhZ2UsDQogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyINCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLmJ1dHRvbl9sb2FkaW5nID0gZmFsc2U7DQogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiUGFya2luZ0luZGV4IiB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICB0aGlzLmJ1dHRvbl9sb2FkaW5nID0gZmFsc2U7DQogICAgICAgIH0pOw0KICAgIH0sDQoNCiAgICAvL+iOt+WPluivpuaDhQ0KICAgIGdldERldGFpbGUoKSB7DQogICAgICBpZiAoIXRoaXMuaWQpIHsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfQ0KICAgICAgUGFya2luZ0RldGFpbGVkKHsgaWQ6IHRoaXMuaWQgfSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhOw0KICAgICAgICAvL+i/mOWOn+aVsOaNrg0KICAgICAgICBmb3IgKGxldCBrZXkgaW4gZGF0YSkgew0KICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmZvcm0pLmluY2x1ZGVzKGtleSkpIHsNCiAgICAgICAgICAgIHRoaXMuZm9ybVtrZXldID0gZGF0YVtrZXldOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvL+iuvue9ruimhueblueJqQ0KICAgICAgICAvL2RvbeWFg+e0oOa4suafk+WujOaIkOS5i+WQjuiwg+eUqA0KICAgICAgICBjb25zdCBzcGxpdExuZ2xhdCA9IGRhdGEubG5nbGF0LnNwbGl0KCIsIik7DQogICAgICAgIGNvbnN0IGxuZ2xhdCA9IHsNCiAgICAgICAgICBsbmc6IHNwbGl0TG5nbGF0WzBdLA0KICAgICAgICAgIGxhdDogc3BsaXRMbmdsYXRbMV0NCiAgICAgICAgfTsNCiAgICAgICAgdGhpcy4kcmVmcy5hbWFwLnNldE1hcmtlcihsbmdsYXQpOw0KICAgICAgICAvL+i/mOWOn+ecgeW4guWMug0KICAgICAgICB0aGlzLiRyZWZzLmNpdHlBcmVhLmluaXREZWZhdWx0KGRhdGEucmVnaW9uKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgLy/ph43nva7ooajljZUNCiAgICByZXNldChmb3JtTmFtZSkgew0KICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsNCiAgICAgIC8v5riF6ZmkY2l0eUFyZWHnmoTlgLwNCiAgICAgIHRoaXMuJHJlZnMuY2l0eUFyZWEuY2xlYXIoKTsNCiAgICAgIHRoaXMuJHJlZnMuYW1hcC5jbGVhck1hcmtlcigpOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/views/Parking","sourcesContent":["<template>\r\n  <div class=\"parking-add\">\r\n    <el-form\r\n      :inline-message=\"true\"\r\n      ref=\"form\"\r\n      :rules=\"rules\"\r\n      :model=\"form\"\r\n      label-width=\"110px\"\r\n      size=\"small\"\r\n    >\r\n      <el-form-item label=\"停车场名称\" prop=\"parkingName\">\r\n        <el-input v-model=\"form.parkingName\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"区域\" prop=\"area\">\r\n        <CityArea\r\n          ref=\"cityArea\"\r\n          :mapLocation=\"true\"\r\n          :cityAreaValue.sync=\"form.area\"\r\n          @callback=\"callbackComponent\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"详细地址\" prop=\"address\">\r\n        <el-input v-model=\"form.address\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"类型\" prop=\"type\">\r\n        <el-radio-group v-model=\"form.type\">\r\n          <el-radio v-for=\"item in type\" :key=\"item.value\" :label=\"item.value\">{{ item.label }}</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"可停放车辆\" prop=\"carsNumber\">\r\n        <el-input v-model.number=\"form.carsNumber\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"禁启用\" prop=\"status\">\r\n        <el-radio-group v-model=\"form.status\">\r\n          <el-radio v-for=\"item in status\" :key=\"item.value\" :label=\"item.value\">{{ item.label }}</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"位置\">\r\n        <div class=\"address-map\">\r\n          <AMap ref=\"amap\" :options=\"option_map\" @callback=\"callbackComponent\" />\r\n        </div>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"经纬度\" prop=\"lnglat\">\r\n        <el-input v-model=\"form.lnglat\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button type=\"danger\" :loading=\"button_loading\" @click=\"onSubmit('form')\">确定</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//AMAP\r\nimport AMap from \"../amap\";\r\n// 组件\r\nimport CityArea from \"@c/common/cityArea\";\r\n//API\r\nimport { ParkingAdd, ParkingDetailed, ParkingEdit } from \"@/api/parking\";\r\nexport default {\r\n  name: \"ParkingAdd\",\r\n  data() {\r\n    return {\r\n      //id\r\n      id: this.$route.query.id,\r\n      //地图配置\r\n      option_map: { mapLoad: true },\r\n      status: this.$store.state.config.parking_status,\r\n      type: this.$store.state.config.parking_type,\r\n      form: {\r\n        parkingName: \"\",\r\n        area: \"\",\r\n        address: \"\",\r\n        type: \"\",\r\n        carsNumber: \"\",\r\n        status: \"\",\r\n        lnglat: \"\",\r\n        content: \"\"\r\n      },\r\n      button_loading: false,\r\n      //验证表单规则\r\n      rules: {\r\n        parkingName: [\r\n          { required: true, message: \"请输入停车场名称\", trigger: \"blur\" }\r\n        ],\r\n        carsNumber: [\r\n          { required: true, message: \"数量不能为空\", trigger: \"blur\" },\r\n          { type: \"number\", message: \"请输入数字\" }\r\n        ],\r\n        area: [{ required: true, message: \"请选择城市区\", trigger: \"change\" }],\r\n        lnglat: [{ required: true, message: \"经纬度不能为空\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  components: { AMap, CityArea },\r\n  beforeMount() {},\r\n  mounted() {},\r\n  methods: {\r\n    callbackComponent(params) {\r\n      if (params.function) {\r\n        this[params.function](params.data);\r\n      }\r\n    },\r\n    //地图加载完成\r\n    mapLoad() {\r\n      this.getDetaile();\r\n    },\r\n    setMapCenter(data) {\r\n      this.$refs.amap.setMapCenter(data.address);\r\n    },\r\n    getLnglat(data) {\r\n      this.form.lnglat = data.lnglat.value;\r\n    },\r\n    //提交表单\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.button_loading = true;\r\n          this.id ? this.editParking() : this.addParking();\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //新增停车场API\r\n    addParking() {\r\n      ParkingAdd(this.form)\r\n        .then(response => {\r\n          this.reset(\"form\");\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.reset();\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //编辑停车场API\r\n    editParking() {\r\n      let requestData = JSON.parse(JSON.stringify(this.form));\r\n      requestData.id = this.id;\r\n      ParkingEdit(requestData)\r\n        .then(response => {\r\n          this.reset(\"form\");\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.$router.push({ name: \"ParkingIndex\" });\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //获取详情\r\n    getDetaile() {\r\n      if (!this.id) {\r\n        return false;\r\n      }\r\n      ParkingDetailed({ id: this.id }).then(response => {\r\n        const data = response.data;\r\n        //还原数据\r\n        for (let key in data) {\r\n          if (Object.keys(this.form).includes(key)) {\r\n            this.form[key] = data[key];\r\n          }\r\n        }\r\n        //设置覆盖物\r\n        //dom元素渲染完成之后调用\r\n        const splitLnglat = data.lnglat.split(\",\");\r\n        const lnglat = {\r\n          lng: splitLnglat[0],\r\n          lat: splitLnglat[1]\r\n        };\r\n        this.$refs.amap.setMarker(lnglat);\r\n        //还原省市区\r\n        this.$refs.cityArea.initDefault(data.region);\r\n      });\r\n    },\r\n    //重置表单\r\n    reset(formName) {\r\n      this.$refs[formName].resetFields();\r\n      //清除cityArea的值\r\n      this.$refs.cityArea.clear();\r\n      this.$refs.amap.clearMarker();\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.address-map {\r\n  width: 80%;\r\n  height: 300px;\r\n}\r\n.el-input {\r\n  width: 30%;\r\n}\r\n</style>"]}]}
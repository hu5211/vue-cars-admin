{"remainingRequest":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue?vue&type=style&index=0&id=3fc9df00&lang=scss&scoped=true&","dependencies":[{"path":"D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue","mtime":1598914996643},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5hZGRyZXNzLW1hcCB7DQogIHdpZHRoOiA4MCU7DQogIGhlaWdodDogMzAwcHg7DQp9DQouZWwtaW5wdXQgew0KICB3aWR0aDogMzAlOw0KfQ0K"},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuOA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/views/Parking","sourcesContent":["<template>\r\n  <div class=\"parking-add\">\r\n    <FormData ref=\"vuForm\" :formData=\"form_data\" :formItem=\"form_item\" :formHandler=\"form_handler\">\r\n      <template v-slot:city>\r\n        <CityArea\r\n          ref=\"cityArea\"\r\n          :mapLocation=\"true\"\r\n          :cityAreaValue.sync=\"form_data.area\"\r\n          @callback=\"callbackComponent\"\r\n        />\r\n      </template>\r\n      <template v-slot:amap>\r\n        <div class=\"address-map\">\r\n          <AMap ref=\"amap\" :options=\"option_map\" @callback=\"callbackComponent\" />\r\n        </div>\r\n      </template>\r\n    </FormData>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//AMAP\r\nimport AMap from \"../amap\";\r\n// 组件\r\nimport CityArea from \"@c/common/cityArea\";\r\nimport FormData from \"@c/formData\";\r\n//API\r\nimport { ParkingAdd, ParkingDetailed, ParkingEdit } from \"@/api/parking\";\r\nexport default {\r\n  name: \"ParkingAdd\",\r\n  data() {\r\n    let validateNumber = (rule, value, callback) => {\r\n      const regNumber = /^[0-9]*$/;\r\n      if (!value) {\r\n        callback(new Error(\"请输入可停放车辆\"));\r\n      } else if (!regNumber.test(value)) {\r\n        callback(new Error(\"请输入数字\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      //表单数据配置\r\n      form_data: {\r\n        parkingName: \"\",\r\n        area: \"\",\r\n        address: \"\",\r\n        type: \"\",\r\n        carsNumber: \"\",\r\n        status: \"\",\r\n        lnglat: \"\"\r\n      },\r\n      //表单配置\r\n      form_item: [\r\n        {\r\n          type: \"Input\",\r\n          label: \"停车场名称\",\r\n          placeholder: \"请输入停车场名称\",\r\n          prop: \"parkingName\",\r\n          width: \"300px\",\r\n          required: true\r\n        },\r\n        {\r\n          type: \"Slot\",\r\n          slotName: \"city\",\r\n          label: \"区域\",\r\n          prop: \"area\"\r\n        },\r\n        {\r\n          type: \"Input\",\r\n          label: \"详细地址\",\r\n          placeholder: \"请输入详细地址\",\r\n          prop: \"address\",\r\n          width: \"600px\",\r\n          required: true\r\n        },\r\n        {\r\n          type: \"Radio\",\r\n          label: \"类型\",\r\n          prop: \"type\",\r\n          options: this.$store.state.config.parking_type,\r\n          required: true\r\n        },\r\n        {\r\n          type: \"Input\",\r\n          label: \"可停放车辆\",\r\n          placeholder: \"请输入数字类型\",\r\n          prop: \"carsNumber\",\r\n          width: \"150px\",\r\n          required: true,\r\n          validator: [{ validator: validateNumber, trigger: \"change\" }]\r\n        },\r\n        {\r\n          type: \"Radio\",\r\n          label: \"禁启用\",\r\n          prop: \"status\",\r\n          options: this.$store.state.config.radio_status,\r\n          required: true\r\n        },\r\n        {\r\n          type: \"Slot\",\r\n          slotName: \"amap\",\r\n          label: \"位置\"\r\n        },\r\n        {\r\n          type: \"Input\",\r\n          label: \"经纬度\",\r\n          placeholder: \"请选择地图\",\r\n          prop: \"lnglat\",\r\n          width: \"200px\",\r\n          disabled: true\r\n        }\r\n      ],\r\n      form_handler: [\r\n        {\r\n          label: \"确定\",\r\n          key: \"submit\",\r\n          type: \"danger\",\r\n          handler: () => this.formValidate()\r\n        }\r\n      ],\r\n      //id\r\n      id: this.$route.query.id,\r\n      //地图配置\r\n      option_map: { mapLoad: true },\r\n      radio_status: this.$store.state.config.radio_status,\r\n      type: this.$store.state.config.parking_type,\r\n      button_loading: false\r\n    };\r\n  },\r\n  components: { AMap, CityArea, FormData },\r\n  beforeMount() {},\r\n  mounted() {},\r\n  methods: {\r\n    formValidate() {\r\n      this.$refs.vuForm.$refs.form.validate(valid => {\r\n        if (valid) {\r\n          this.button_loading = true;\r\n          this.id ? this.editParking() : this.addParking();\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    callbackComponent(params) {\r\n      if (params.function) {\r\n        this[params.function](params.data);\r\n      }\r\n    },\r\n    //地图加载完成\r\n    mapLoad() {\r\n      this.getDetaile();\r\n    },\r\n    setMapCenter(data) {\r\n      this.$refs.amap.setMapCenter(data.address);\r\n    },\r\n    getLnglat(data) {\r\n      this.form_data.lnglat = data.lnglat.value;\r\n    },\r\n    //新增停车场API\r\n    addParking() {\r\n      ParkingAdd(this.form_data)\r\n        .then(response => {\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.$router.push({\r\n            name: \"ParkingIndex\"\r\n          });\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //编辑停车场API\r\n    editParking() {\r\n      let requestData = JSON.parse(JSON.stringify(this.form_data));\r\n      requestData.id = this.id;\r\n      ParkingEdit(requestData)\r\n        .then(response => {\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.$router.push({ name: \"ParkingIndex\" });\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //获取详情\r\n    getDetaile() {\r\n      if (!this.id) {\r\n        return false;\r\n      }\r\n      ParkingDetailed({ id: this.id }).then(response => {\r\n        const data = response.data;\r\n        //还原数据\r\n        for (let key in data) {\r\n          if (Object.keys(this.form_data).includes(key)) {\r\n            this.form_data[key] = data[key];\r\n          }\r\n        }\r\n        //设置覆盖物\r\n        //dom元素渲染完成之后调用\r\n        const splitLnglat = data.lnglat.split(\",\");\r\n        const lnglat = {\r\n          lng: splitLnglat[0],\r\n          lat: splitLnglat[1]\r\n        };\r\n        this.$refs.amap.setMarker(lnglat);\r\n        //还原省市区\r\n        this.$refs.cityArea.initDefault(data.region);\r\n      });\r\n    }\r\n    //重置表单\r\n    // reset(formName) {\r\n    //   this.$refs[formName].resetFields();\r\n    //   //清除cityArea的值\r\n    //   this.$refs.cityArea.clear();\r\n    //   this.$refs.amap.clearMarker();\r\n    // }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.address-map {\r\n  width: 80%;\r\n  height: 300px;\r\n}\r\n.el-input {\r\n  width: 30%;\r\n}\r\n</style>"]}]}
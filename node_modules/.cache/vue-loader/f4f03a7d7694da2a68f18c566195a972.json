{"remainingRequest":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue?vue&type=style&index=0&id=3fc9df00&lang=scss&scoped=true&","dependencies":[{"path":"D:\\vue-cars\\vue-cars-admin\\src\\views\\Parking\\add.vue","mtime":1598702059861},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-cars\\vue-cars-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5hZGRyZXNzLW1hcCB7DQogIHdpZHRoOiA4MCU7DQogIGhlaWdodDogMzAwcHg7DQp9DQouZWwtaW5wdXQgew0KICB3aWR0aDogMzAlOw0KfQ0K"},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4MA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/views/Parking","sourcesContent":["<template>\r\n  <div class=\"parking-add\">\r\n    <el-form\r\n      :inline-message=\"true\"\r\n      ref=\"form\"\r\n      :rules=\"rules\"\r\n      :model=\"form\"\r\n      label-width=\"110px\"\r\n      size=\"small\"\r\n    >\r\n      <el-form-item label=\"停车场名称\" prop=\"parkingName\">\r\n        <el-input v-model=\"form.parkingName\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"区域\" prop=\"area\">\r\n        <CityArea\r\n          ref=\"cityArea\"\r\n          :mapLocation=\"true\"\r\n          :cityAreaValue.sync=\"form.area\"\r\n          @callback=\"callbackComponent\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"详细地址\" prop=\"address\">\r\n        <el-input v-model=\"form.address\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"类型\" prop=\"type\">\r\n        <el-radio-group v-model=\"form.type\">\r\n          <el-radio v-for=\"item in type\" :key=\"item.value\" :label=\"item.value\">{{ item.label }}</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"可停放车辆\" prop=\"carsNumber\">\r\n        <el-input v-model.number=\"form.carsNumber\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"禁启用\" prop=\"status\">\r\n        <el-radio-group v-model=\"form.status\">\r\n          <el-radio v-for=\"item in status\" :key=\"item.value\" :label=\"item.value\">{{ item.label }}</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"位置\">\r\n        <div class=\"address-map\">\r\n          <AMap ref=\"amap\" :options=\"option_map\" @callback=\"callbackComponent\" />\r\n        </div>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"经纬度\" prop=\"lnglat\">\r\n        <el-input v-model=\"form.lnglat\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button type=\"danger\" :loading=\"button_loading\" @click=\"onSubmit('form')\">确定</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//AMAP\r\nimport AMap from \"../amap\";\r\n// 组件\r\nimport CityArea from \"@c/common/cityArea\";\r\n//API\r\nimport { ParkingAdd, ParkingDetailed, ParkingEdit } from \"@/api/parking\";\r\nexport default {\r\n  name: \"ParkingAdd\",\r\n  data() {\r\n    return {\r\n      //id\r\n      id: this.$route.query.id,\r\n      //地图配置\r\n      option_map: { mapLoad: true },\r\n      status: this.$store.state.config.parking_status,\r\n      type: this.$store.state.config.parking_type,\r\n      form: {\r\n        parkingName: \"\",\r\n        area: \"\",\r\n        address: \"\",\r\n        type: \"\",\r\n        carsNumber: \"\",\r\n        status: \"\",\r\n        lnglat: \"\",\r\n        content: \"\"\r\n      },\r\n      button_loading: false,\r\n      //验证表单规则\r\n      rules: {\r\n        parkingName: [\r\n          { required: true, message: \"请输入停车场名称\", trigger: \"blur\" }\r\n        ],\r\n        carsNumber: [\r\n          { required: true, message: \"数量不能为空\", trigger: \"blur\" },\r\n          { type: \"number\", message: \"请输入数字\" }\r\n        ],\r\n        area: [{ required: true, message: \"请选择城市区\", trigger: \"change\" }],\r\n        lnglat: [{ required: true, message: \"经纬度不能为空\", trigger: \"blur\" }]\r\n      }\r\n    };\r\n  },\r\n  components: { AMap, CityArea },\r\n  beforeMount() {},\r\n  mounted() {},\r\n  methods: {\r\n    callbackComponent(params) {\r\n      if (params.function) {\r\n        this[params.function](params.data);\r\n      }\r\n    },\r\n    //地图加载完成\r\n    mapLoad() {\r\n      this.getDetaile();\r\n    },\r\n    setMapCenter(data) {\r\n      this.$refs.amap.setMapCenter(data.address);\r\n    },\r\n    getLnglat(data) {\r\n      this.form.lnglat = data.lnglat.value;\r\n    },\r\n    //提交表单\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          this.button_loading = true;\r\n          this.id ? this.editParking() : this.addParking();\r\n        } else {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    //新增停车场API\r\n    addParking() {\r\n      ParkingAdd(this.form)\r\n        .then(response => {\r\n          this.reset(\"form\");\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.reset();\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //编辑停车场API\r\n    editParking() {\r\n      let requestData = JSON.parse(JSON.stringify(this.form));\r\n      requestData.id = this.id;\r\n      ParkingEdit(requestData)\r\n        .then(response => {\r\n          this.reset(\"form\");\r\n          this.$message({\r\n            message: response.message,\r\n            type: \"success\"\r\n          });\r\n          this.button_loading = false;\r\n          this.$router.push({ name: \"ParkingIndex\" });\r\n        })\r\n        .catch(error => {\r\n          this.button_loading = false;\r\n        });\r\n    },\r\n\r\n    //获取详情\r\n    getDetaile() {\r\n      if (!this.id) {\r\n        return false;\r\n      }\r\n      ParkingDetailed({ id: this.id }).then(response => {\r\n        const data = response.data;\r\n        //还原数据\r\n        for (let key in data) {\r\n          if (Object.keys(this.form).includes(key)) {\r\n            this.form[key] = data[key];\r\n          }\r\n        }\r\n        //设置覆盖物\r\n        //dom元素渲染完成之后调用\r\n        const splitLnglat = data.lnglat.split(\",\");\r\n        const lnglat = {\r\n          lng: splitLnglat[0],\r\n          lat: splitLnglat[1]\r\n        };\r\n        this.$refs.amap.setMarker(lnglat);\r\n        //还原省市区\r\n        this.$refs.cityArea.initDefault(data.region);\r\n      });\r\n    },\r\n    //重置表单\r\n    reset(formName) {\r\n      this.$refs[formName].resetFields();\r\n      //清除cityArea的值\r\n      this.$refs.cityArea.clear();\r\n      this.$refs.amap.clearMarker();\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.address-map {\r\n  width: 80%;\r\n  height: 300px;\r\n}\r\n.el-input {\r\n  width: 30%;\r\n}\r\n</style>"]}]}